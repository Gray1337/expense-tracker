{"ast":null,"code":"import{useContext}from'react';import{ExpenseTrackerContext}from\"../context/context\";import{incomeCategories,expenseCategories,resetCategories}from\"../constants/categories\";var useTransaction=function useTransaction(_ref){var title=_ref.title;// 讀取transactions的值\nvar _useContext=useContext(ExpenseTrackerContext),transactions=_useContext.transactions;// 區分title=收入/支出\nvar transactionPerType=transactions.filter(function(t){return t.type===title;});// 加總收入/支出的總額\nvar total=transactionPerType.reduce(function(acc,currVal){return acc+=currVal.amount;},0);// 區分種類\nvar categories=title==='收入'?incomeCategories:expenseCategories;// 把原始catergory的amount(0)加上新增的amount(n)\ntransactionPerType.forEach(function(t){var category=categories.find(function(c){return c.type===t.category;});if(category){category.amount+=t.amount;}});// 過濾amount=0的種類\nvar filteredCategory=categories.filter(function(c){return c.amount>0;});console.log('test',{total:total,transactionPerType:transactionPerType,categories:categories});var chartData={datasets:[{data:filteredCategory.map(function(c){return c.amount;}),backgroundColor:filteredCategory.map(function(c){return c.color;})}],labels:filteredCategory.map(function(c){return c.type;})};resetCategories();return{total:total,chartData:chartData};};export default useTransaction;","map":{"version":3,"sources":["C:/Users/Gray/Desktop/前端工程/expense-tracker-app/src/useTransactionAPI/useTransaction.js"],"names":["useContext","ExpenseTrackerContext","incomeCategories","expenseCategories","resetCategories","useTransaction","title","transactions","transactionPerType","filter","t","type","total","reduce","acc","currVal","amount","categories","forEach","category","find","c","filteredCategory","console","log","chartData","datasets","data","map","backgroundColor","color","labels"],"mappings":"AAAA,OAASA,UAAT,KAA2B,OAA3B,CACA,OAASC,qBAAT,KAAsC,oBAAtC,CACA,OAASC,gBAAT,CAA2BC,iBAA3B,CAA8CC,eAA9C,KAAqE,yBAArE,CAEA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,MAAY,IAAVC,CAAAA,KAAU,MAAVA,KAAU,CACjC;AADiC,gBAERN,UAAU,CAACC,qBAAD,CAFF,CAEzBM,YAFyB,aAEzBA,YAFyB,CAGjC;AACA,GAAMC,CAAAA,kBAAkB,CAAGD,YAAY,CAACE,MAAb,CAAoB,SAACC,CAAD,QAAMA,CAAAA,CAAC,CAACC,IAAF,GAAWL,KAAjB,EAApB,CAA3B,CACA;AACA,GAAMM,CAAAA,KAAK,CAAGJ,kBAAkB,CAACK,MAAnB,CAA0B,SAACC,GAAD,CAAKC,OAAL,QAAgBD,CAAAA,GAAG,EAAIC,OAAO,CAACC,MAA/B,EAA1B,CAAiE,CAAjE,CAAd,CACA;AACA,GAAMC,CAAAA,UAAU,CAAGX,KAAK,GAAK,IAAV,CAAiBJ,gBAAjB,CAAoCC,iBAAvD,CACA;AACAK,kBAAkB,CAACU,OAAnB,CAA2B,SAAAR,CAAC,CAAI,CAC9B,GAAMS,CAAAA,QAAQ,CAAGF,UAAU,CAACG,IAAX,CAAgB,SAAAC,CAAC,QAAEA,CAAAA,CAAC,CAACV,IAAF,GAAWD,CAAC,CAACS,QAAf,EAAjB,CAAjB,CACA,GAAGA,QAAH,CAAa,CAAEA,QAAQ,CAACH,MAAT,EAAmBN,CAAC,CAACM,MAArB,CAA6B,CAC7C,CAHD,EAIA;AACA,GAAMM,CAAAA,gBAAgB,CAAGL,UAAU,CAACR,MAAX,CAAmB,SAAAY,CAAC,QAAIA,CAAAA,CAAC,CAACL,MAAF,CAAW,CAAf,EAApB,CAAzB,CAEAO,OAAO,CAACC,GAAR,CAAY,MAAZ,CAAmB,CAACZ,KAAK,CAALA,KAAD,CAAOJ,kBAAkB,CAAlBA,kBAAP,CAA0BS,UAAU,CAAVA,UAA1B,CAAnB,EAEA,GAAMQ,CAAAA,SAAS,CAAE,CACfC,QAAQ,CAAC,CAAC,CACRC,IAAI,CAACL,gBAAgB,CAACM,GAAjB,CAAqB,SAAAP,CAAC,QAAIA,CAAAA,CAAC,CAACL,MAAN,EAAtB,CADG,CAERa,eAAe,CAACP,gBAAgB,CAACM,GAAjB,CAAqB,SAAAP,CAAC,QAAIA,CAAAA,CAAC,CAACS,KAAN,EAAtB,CAFR,CAAD,CADM,CAKfC,MAAM,CAACT,gBAAgB,CAACM,GAAjB,CAAqB,SAAAP,CAAC,QAAIA,CAAAA,CAAC,CAACV,IAAN,EAAtB,CALQ,CAAjB,CAOAP,eAAe,GAEf,MAAQ,CAACQ,KAAK,CAALA,KAAD,CAAQa,SAAS,CAATA,SAAR,CAAR,CACD,CA7BD,CA+BA,cAAepB,CAAAA,cAAf","sourcesContent":["import { useContext } from 'react';\r\nimport { ExpenseTrackerContext } from \"../context/context\";\r\nimport { incomeCategories, expenseCategories, resetCategories } from \"../constants/categories\";\r\n\r\nconst useTransaction = ({title}) =>{\r\n  // 讀取transactions的值\r\n  const { transactions } = useContext(ExpenseTrackerContext)\r\n  // 區分title=收入/支出\r\n  const transactionPerType = transactions.filter((t)=> t.type === title)\r\n  // 加總收入/支出的總額\r\n  const total = transactionPerType.reduce((acc,currVal)=> acc += currVal.amount ,0)\r\n  // 區分種類\r\n  const categories = title === '收入' ? incomeCategories : expenseCategories\r\n  // 把原始catergory的amount(0)加上新增的amount(n)\r\n  transactionPerType.forEach(t => {\r\n    const category = categories.find(c=>c.type === t.category)\r\n    if(category) { category.amount += t.amount }\r\n  });\r\n  // 過濾amount=0的種類\r\n  const filteredCategory = categories.filter( c => c.amount > 0 )\r\n\r\n  console.log('test',{total,transactionPerType,categories})\r\n\r\n  const chartData ={\r\n    datasets:[{\r\n      data:filteredCategory.map(c => c.amount),\r\n      backgroundColor:filteredCategory.map(c => c.color)\r\n    }],\r\n    labels:filteredCategory.map(c => c.type)\r\n  }\r\n  resetCategories()\r\n\r\n  return ({total, chartData})\r\n}\r\n\r\nexport default useTransaction"]},"metadata":{},"sourceType":"module"}